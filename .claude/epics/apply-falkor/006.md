---
name: Extend integration tests for dual-database support
status: closed
created: 2025-09-05T10:40:37Z
updated: 2025-09-07T00:40:00Z
github: https://github.com/sacahan/graphiti/issues/7
depends_on: [004]
parallel: true
conflicts_with: []
---

# Task: Extend integration tests for dual-database support

## Description

Extend the existing integration test suite to support both Neo4j and FalkorDB backends, ensuring feature parity and preventing regressions. Create comprehensive test coverage for database switching functionality.

## Acceptance Criteria

- [ ] All existing integration tests pass with both Neo4j and FalkorDB backends
- [ ] Test suite supports running against both databases via environment variables
- [ ] New tests specifically for database factory and switching functionality
- [ ] Performance regression tests to ensure Neo4j performance unchanged
- [ ] FalkorDB-specific tests for Redis-based features
- [ ] CI pipeline supports testing both database backends
- [ ] > 90% test coverage for new database selection code paths

## Technical Details

### Implementation Approach

- Parameterize existing integration tests to run against both backends
- Create database-specific test fixtures for Neo4j and FalkorDB
- Add tests for `DriverFactory` and configuration validation
- Implement performance benchmarking tests
- Update CI configuration to test both backends

### Test Categories to Extend

- **Core Functionality**: All existing Graphiti operations with both backends
- **Database Factory**: Driver selection and configuration validation
- **Performance**: Startup time, memory usage, query latency benchmarks
- **Error Handling**: Database-specific error scenarios and recovery
- **MCP Server**: Integration tests with both database backends

### Code Locations/Files Affected

- Update: `tests/` - Parameterize existing integration tests
- New: `tests/driver/test_factory_integration.py`
- New: `tests/performance/test_backend_benchmarks.py`
- Update: CI configuration files (.github/workflows/)
- New: Test fixtures for dual-database scenarios

## Dependencies

- [ ] Task 004 completed (database switching functionality implemented)
- [ ] Both Neo4j and FalkorDB test databases available
- [ ] Existing test suite understanding and patterns

## Effort Estimate

- **Size**: L
- **Hours**: 12-15 hours
- **Parallel**: true (can work alongside MCP optimization)

## Definition of Done

- [ ] All existing integration tests pass with both Neo4j and FalkorDB
- [ ] Database factory functionality comprehensively tested
- [ ] Performance benchmarks established and automated
- [ ] CI pipeline tests both database backends
- [ ] Test coverage >90% for new database selection code
- [ ] No performance regression detected in Neo4j tests
- [ ] FalkorDB-specific functionality validated through tests
